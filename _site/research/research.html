<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.545">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Kenneth Blake Vernon</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="..//images/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<meta property="og:title" content="Kenneth Blake Vernon">
<meta property="og:image" content="https://www.kbvernon.io/images/green_grass_valley-meta.jpg">
<meta property="og:site_name" content="Kenneth Blake Vernon">
<meta name="twitter:title" content="Kenneth Blake Vernon">
<meta name="twitter:image" content="https://www.kbvernon.io/images/green_grass_valley-meta.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">KBV</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-research" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-research">    
        <li>
    <a class="dropdown-item" href="../research/research.html">
 <span class="dropdown-text">Research summary</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/publications.html">
 <span class="dropdown-text">Publications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../research/presentations.html">
 <span class="dropdown-text">Presentations</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="../teaching/philosophy.html">
 <span class="dropdown-text">Teaching statement</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../teaching/diversity.qmd">
 <span class="dropdown-text">Diversity statement</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../teaching/classes.qmd">
 <span class="dropdown-text">Classes</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:Kenneth.Vernon@colorado.edu"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kbvernon/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0003-0098-5092"> 
<span class="menu-text"><i class="ai  ai-orcid ai-lg" title="" style="color:"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=2PE4za4AAAAJ&amp;hl=en"> 
<span class="menu-text"><i class="ai  ai-google-scholar ai-lg" title="" style="color:"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blake_vitae.pdf"> 
<span class="menu-text"><i class="ai  ai-cv ai-lg" title="" style="color:"></i></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research-statement" id="toc-research-statement" class="nav-link active" data-scroll-target="#research-statement">RESEARCH STATEMENT</a>
  <ul class="collapse">
  <li><a href="#for-ordinary-people" id="toc-for-ordinary-people" class="nav-link" data-scroll-target="#for-ordinary-people"><span class="kobe">For ordinary people</span></a></li>
  <li><a href="#for-academics" id="toc-for-academics" class="nav-link" data-scroll-target="#for-academics"><span class="kobe">For academics</span></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<div class="small text-muted">
<p>LAST UPDATED<br>
2024-04-28</p>
<p>DISCLAIMER<br>
This statement - elevator pitch, really - describes my primary research interests. Here it comes in two versions. One you can find under the heading “For academics.” This version is an example of a type of statement typically written by desperate intellectuals looking for a job. If you’re on a hiring committee, this version is definitely for you.</p>
<p>If you’re not on a hiring committee, though, and you’re not an academic, then wow! It’s cool that you’re here! I’ve written another version of this research statement just for you! You can find it under the heading “For ordinary people.” The tedious, puffed-up jargon has for the most part been removed, so it reads more like a conversation about an idea I happen to find very interesting.</p>
</div>
<section id="research-statement" class="level2">
<h2 class="anchored" data-anchor-id="research-statement">RESEARCH STATEMENT</h2>
<section id="for-ordinary-people" class="level3">
<h3 class="anchored" data-anchor-id="for-ordinary-people"><span class="kobe">For ordinary people</span></h3>
<p>Demographers point to 2007 as the year <a href="https://ourworldindata.org/grapher/urban-and-rural-population?time=1960..latest">the number of humans living in cities first eclipsed the global rural population</a>. 2007! Human beings have been on this earth for nearly 300,000 years (longer by some measures), and we spent almost all of that time in small groups tooling around in Africa. In fact, it was only some 60,000 years ago that a substantial number of our kind dared to venture out from our ancestral homeland. For the next 50,000 years, we <a href="https://www.pnas.org/doi/full/10.1073/pnas.1209494109">spread in fits and starts across the globe</a>. After that came small villages, towns, cities, states, empires, and the vast metropolises of the modern world.</p>
<p>It wasn’t fate that led us to concentrate in the places we did, or concentrate at all, but we did! And I want to know why! What led to the geographic differences in the <strong>density</strong> of human populations that we see today?</p>
<p>An interesting quirk about density is that it can affect the likelihood that more people move to a place, meaning density can sometimes be its own cause! To see how this works, imagine two places that have more or less identical environments (same climate, same agricultural productivity, same number of jobs, same cost of living, etc.) and identical population densities (so, the same number of people per unit area). Now imagine one of these places experiences a spontaneous increase in its total population size. All else being equal, this change in population density should lead to more jobs to meet the increasing demand for goods and services, reduced transport costs as people live closer together, and increased investments in infrastructure and other public goods required to support those interactions. At the same time, it’ll lead to more competition for housing and higher rents, more transport congestion, more risk of disease spreading, and in general more strain on quality of life.</p>
<p>These outcomes are sometimes referred to as density-dependent effects. When the positive effects outweigh the negative effects, you get conditions that encourage people to aggregate or cluster (to move to the more densely populated area). When the negative effects outweigh the positive effects, you get conditions that encourage people to spread out or disperse (to move to the less densely populated area). It’s hard to look at our spread across the globe and not see these effects at work, with negative effects playing an outsized role up until about 12,000 years ago, when we started to aggregate into towns and villages.</p>
<p>So, what do I personally find so interesting about all this? For starters, I find the methodological challenges that these sorts of spatial questions raise really engaging, like a complex game of Sudoku, but one happening on a map, and involving real people. I also appreciate that these processes are not unique to the modern world. They’re not even unique to our species! In fact, they happen all over the animal kingdom, from schooling fish to crowding emperor penguins, and we can learn a lot about how we handle those processes by investigating the ways our non-human cousins do.</p>
<p>Finally, as an archaeologist, I appreciate that these questions give what are often perceived to be extremely niche academic interests a little more relevance to the modern world. Just look at the general upheaval of the last fifteen years, from the Great Recession to the Covid pandemic: the rush to flee dense urban cores, the rise of remote work, abandoned office space, ever increasing rents, the commodification of single-family homes, the homeless crisis, the growth of the service sector, and the collapse of rural labor markets, to name just a few. These are all in their own way the effects of density, acting as forces of aggregation and dispersal. They may have looked differently in the past, but people had to navigate them all the same.</p>
</section>
<section id="for-academics" class="level3" style="margin-top: 1em;">
<h3 style="margin-top: 1em;" class="anchored" data-anchor-id="for-academics"><span class="kobe">For academics</span></h3>
<p>My research investigates trade-offs between aggregation and dispersal in human populations using an integrated set of conceptual tools from behavioral and population ecology, urban geography, and economics, coupled with multiple lines of evidence, including reconstructions of climate and demography, as well as estimates of diet, health, violence, and inequality. The common thread throughout is the concept of <em>density</em>, specifically <em>density-dependent effects</em>, which may promote aggregation or dispersal. As these socio-ecological dynamics are also inherently spatial processes, they raise their own unique set of challenges (notably, autocorrelation) that in turn require their own unique set of solutions (namely, spatial statistics), so I invest considerable time and energy into advancing spatial data science in anthropology, ecology, and other allied fields. Below, I provide some examples of these efforts, along with some suggestions of how I intend to build on them into the future.</p>
<section id="current-work" class="level4">
<h4 class="anchored" data-anchor-id="current-work">CURRENT WORK</h4>
<p><strong>Subsistence-settlement dynamics.</strong> As a baseline for exploring these issues, my collaborators and I have focused on subsistence strategies, how they can vary in their efficiency across habitats and how that variation can lead to differences in their spatial distribution. Among other things, we’ve modeled alternative foraging strategies as a tool for evaluating the Numic expansion into the North American Great Basin (Magargal <em>et al</em> 2017), compared prehistoric farming and foraging settlement patterns within the Grand Staircase-Escalante National Monument (GSENM; Vernon <em>et al</em> 2022), and studied settlement decisions as farming adaptations to climate change (Vernon <em>et al</em> under review).</p>
<p><strong>Trade-offs between aggregation and dispersal.</strong> A recent ethnographic project examines the ways in which traditional ranchers in Baja California Sur, Mexico, balance the benefits of market integration with the necessities of rural life, with an emphasis on how infrastructure development can upend that calculus (Vernon <em>et al</em> under review).</p>
<p>My collaborators and I are also exploring the root causes of violence, with research showing that a marginal environment with an unpredictable resource base may encourage individuals to travel further to secure their subsistence needs, thus increasing their exposure to violence (McCool <em>et al</em> 2022), that an increase in favorable climate conditions followed by a subsequent downturn can lead to both increasing density and resource strain, thus promoting violent contests (McCool <em>et al</em> 2022), and that aggregation and fortification provide a useful proxy for rates of violence among maize farming populations in the Four Corners region (McCool <em>et al</em> in progress).</p>
<p>At CU Boulder’s <a href="https://ibsweb.colorado.edu/archaeology/">Center for Collaborative Synthesis in Archaeology</a> (CCSA), I’m working as a postdoc with <a href="https://ibsweb.colorado.edu/archaeology/people/scott-ortman/">Dr.&nbsp;Scott Ortman</a> on an NSF supported project (Award No.&nbsp;<a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2213921">#2213921</a>) involving researchers from a number of universities, non-profit organizations, and tribal communities to investigate the ways in which networks of social interaction may have shaped the sustainable development of dispersed maize farming communities in the US Southwest prior to European contact, using data from <a href="https://cybersw.org/">cyberSW</a>.</p>
<p><strong>Spatial data science.</strong> To aid in the study of these spatial processes, I also work to improve spatial data science. Examples include a predictive model of archaeological site locations in the GSENM (this actually ended up in a 2018 <a href="http://s3.amazonaws.com/rdcms-aaa/files/production/public/BearsEarsAmicus.pdf"><em>amicus brief</em></a> filed by a coalition of archaeological organizations in support of plaintiffs suing the Trump administration for illegally attempting to reduce the size of the GSENM), a comparative analysis of the ability of various regression and machine learning models to predict the locations of archaeological sites (Yaworsky et al 2020), and a popular point-process model known as Maximum Entropy applied to the same GSENM data (Vernon <em>et al</em> 2022).</p>
<p>One of my primary contributions to the NSF project at CCSA is the development of a novel community detection or clustering algorithm used to define the spatial extent of dispersed maize farming communities (Vernon and Ortman, under review). The algorithm is applied to data from the Village Ecodynamics (VEP) and Southwest Social Networks (SWSN) projects and provides a useful way of exploring changes in density through time and across space.</p>
</section>
<section id="future-goals" class="level4">
<h4 class="anchored" data-anchor-id="future-goals">FUTURE GOALS</h4>
<p><strong>Aggregation and the Collective Action Problem.</strong> One lingering question in my research concerns how aggregations can be sustained without assuming away the collective action problem. Building on work by one of my collaborators (Wilson et al 2023) examining the evolution of hereditary social inequality, my research investigates how the internal structure of a population - involving multiple levels of competition - might help address this problem by supporting specialization and the division of labor.</p>
<p><strong>Spatial data science.</strong> An exciting development in statistical modeling involves the use of multivariate spatio-temporal point process models (MVST-PPMs) for comparative analysis, mostly in epidemiology and ecology. These are not a new class of model, but Bayesian methods for implementing them have gotten a lot of attention recently. They hold great promise as tools to address a number of thorny methodological issues in archaeology and to help tease out socio-ecological drivers of behavior. One example from my research involves using MVST-PPMs to handle extremely small samples, specifically to model just 11 PaleoIndian sites in Grass Valley, Nevada, by comparing them to a larger distribution of later Archaic sites (Vernon <em>et al</em> in progress). Another example, one closer to my theoretical interests, investigates whether individuals are aggregating in response to the presence of others or whether they are simply moving there because of favorable environmental conditions, with one exploring the origins of Chaco great houses (Vernon <em>et al</em> in prep) across the Chaco region and another looking at the origins of community centers in the Four Corners (Vernon <em>et al</em> in prep).</p>
<p>Some other work in the pipeline includes refining a chronology of the Fremont to understand the effects of climate shocks on community resilience in the North American Southwest (NSF HNDS-R $1.2M, co-PI, in prep) and investigating the health and demographic consequences of market integration in Baja, Mexico (NSF HNDS HEGS $350k, co-PI, in prep). These projects will offer undergraduate and graduate students many opportunities to engage directly in scientific research, from data collection to analysis, with a focus on recruiting individuals from underrepresented categories.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2022 Kenneth B. Vernon. Powered by <a href="https://quarto.org/">Quarto</a>.<br>
The source code for this site can be found at its <a href="https://github.com/kbvernon/Blake_down">Github repository</a>.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>