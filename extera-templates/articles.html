<div class="bibliography" id="{{ id }}">
    {%- set references_by_year = bibliography | group_by(attribute="year") -%}
    {%- set years = [] -%}
    {%- for year, reference in references_by_year -%}
    {%- set_global years = years | concat(with=year) -%}
    {%- endfor -%}
    {%- for year in years | reverse %}
    <div class="year-list" id="year-list-{{ year }}">
        <h3 class="year-list-header">{{ year }}</h3>
        {%- set references = references_by_year[year] %}
        {%- for ref in references %}
        <div class="reference">
            <div class="metadata">
                <h5 class="title">{{ ref.title }}</h5>
                <p class="details">
                    {%- if ref.publicationtitle %}
                    <span class="publication">{{ ref.publicationtitle }}</span>
                    {%- endif -%}
                    {%- if ref.volume %} {{ ref.volume }}{% endif -%}
                    {%- if ref.issue %} ({{ ref.issue }}){% endif -%}
                    {%- if ref.pages %}: {{ ref.pages }}{% endif -%}
                    {%- if ref.year %} ({{ ref.year }}){% endif %}
                </p>
                <p class="authors">
                    <iconify-icon role="img" inline icon="bi:people"></iconify-icon>
                    {{ ref.author }}
                </p>
                <p class="doi">
                    {%- if ref.doi %}
                    <span class="icon icon-doi"></span>
                    {{ ref.doi }}
                    {%- endif %}
                </p>
            </div>
            {%- if ref.extra['github'] or ref.extra['preprint'] or ref.url %}
            <div class="buttons">
                {%- if ref.extra['github'] %}
                <a class="btn btn-outline-dark btn-sm" href="{{ ref.extra['github'] }}" rel="noopener noreferrer"
                    aria_label="github" data-original-href="{{ ref.extra['github'] }}">
                    <i class="bi bi-github"></i>
                    <span>GitHub</span>
                </a>
                {%- endif %}
                {%- if ref.extra['preprint'] %}
                <a class="btn btn-outline-dark btn-sm" href="{{ ref.extra['preprint'] }}" rel="noopener noreferrer"
                    aria_label="preprint" data-original-href="{{ ref.extra['preprint'] }}">
                    <i class="bi bi-filetype-pdf"></i>
                    <span>Preprint</span>
                </a>
                {%- endif %}
                {%- if ref.url %}
                <a class="btn btn-outline-dark btn-sm" href="{{ ref.url }}" rel="noopener noreferrer"
                    aria_label="article" data-original-href="{{ ref.url }}">
                    <i class="bi bi-journal-text"></i>
                    <span>Article</span>
                </a>
                {%- endif %}
            </div>
            {%- endif %}
        </div>
        {%- endfor %}
    </div>
    {%- endfor %}
</div>